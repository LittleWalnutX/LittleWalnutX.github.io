<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>
        钢琴AI扒谱安装与体验 - xht - Hexo 
    </title>
     
    
<link rel="stylesheet" href="/css/grid.css">

    
<link rel="stylesheet" href="/css/custom.css">

    
<link rel="stylesheet" href="/css/ringo.css">

     
        <link rel="icon" type="image/x-icon" href="/img/favicon.ico " />
     
     
     
        <meta name=" " content="" />
     
        <meta name=" " content="" />
     
 
<meta name="generator" content="Hexo 6.3.0"></head>

  <body>
    <header id="header" class="clearfix" onclick="window.open('/', '_self')">
    <div class="site-name">
        <a href="/" id="logo" class="site-title">
            xht - Hexo
        </a>
        <p class="description site-description">
            <span style="padding-top:20px; font-size: 10px">
                My Blog
            </span>
        </p>
    </div>
</header>
<div id="sidebar" role="complementary">
    <section class="widget">
        <ul class="menu widget-list">
            
        </ul>
    </section>
    <section class="widget sidebar-foot">
        <ul class="widget-list">
            <li>Theme <a rel="nofollow" target="_blank" href="https://github.com/HeliumOI/hexo-theme-ringo">Ringo</a>
                by <a target="_blank" href="/ "> xht  </a></li>
            <li>Proudly powered by  <a rel="nofollow" target="_blank" href="https://hexo.io/">Hexo</a></li>
        </ul>
    </section>
</div>

<div id="helpbar">
    <div class="back-to-top">
        <button id="back2top">↑</button>
        <script>
            back2top.onclick = function() {
                var movement = document.body.scrollTop || document.documentElement.scrollTop;
                scrollBy(0, -movement);
            }
        </script>
    </div>
</div>
      <main class="main">
        <div id="body">
          <div class="container">
            <div class="col-12" id="main" role="main">
    <article class="post post-atpost" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="post-title">
            <h1 class="post-title post-title-atpage" itemprop="name headline">
                <a itemprop="url" href="/2023/06/18/%E9%92%A2%E7%90%B4AI%E6%89%92%E8%B0%B1/">
                    钢琴AI扒谱安装与体验
                </a>
            </h1>
        </div>
        <ul class="post-meta post-meta-atpage">
            <li class="post-time">
                2023-06-18
            </li>
            <li>
                <div class="article-category">
                    
                </div>
            </li>
        </ul>
        <div class="post-content" itemprop="articleBody">
            <h1 id="钢琴AI扒谱，软件安装与体验"><a href="#钢琴AI扒谱，软件安装与体验" class="headerlink" title="钢琴AI扒谱，软件安装与体验"></a>钢琴AI扒谱，软件安装与体验</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>这个软件是一个github上开源的AI扒谱软件，效果极端优秀，可以把任何力度、节奏等等的扒到位。</p>
<p>github地址<a target="_blank" rel="noopener" href="https://kgithub.com/qiuqiangkong/piano_transcription_inference">https://kgithub.com/qiuqiangkong/piano_transcription_inference</a></p>
<p>这个软件是只能扒成midi, 也就是一个通用的音乐格式，但是这个midi是不会有任何谱面记号的，也正因为如此，midi可以做到很好的自由度和还原度。</p>
<p>musescore软件可以直接打开midi。</p>
<p>因为这个原因，所以如果你直接用musescore软件打开的话，虽然谱面的音符你是直接可以看到了，但是midi原本的还原度也丧失了很多，听起来怪怪的，而且谱面是很差劲的，很乱的。所以尽量安装一个其他的软件来读取midi文件。</p>
<p>虽然不能直接制作成谱子，但是可以参考音符的位置，然后再人工添加记号，省下了很多听音的时间。</p>
<p>archlinuxWiki上说，vlc在archlinux官方源里面没有支持midi, however, vlc-git in AUR是支持的，或者你也可以安装vlc-plugin-fluidsynth-bin来使vlc支持。</p>
<p>就算支持了，midi也需要软音源来播放，可以理解为一个包括了很多乐器发出的声音的文件，然后midi就是乐谱，电脑就是演奏者，根据乐谱来实时演奏。</p>
<p>这个软音源，比较流行的有Fluid-soundfont.tar.gz，在archlinux community源里面，可以直接使用yay或者pacman安装。其他的linux distrobutions我暂时不清楚可不可以。</p>
<p>这个项目的要下载的东西不多的，不像stable-diffusion那样把我剩下了10多个GB的内存全部卡爆。</p>
<pre><code class="lang-bash">yay -S soundfont-fluid
</code></pre>
<p>安装好了以后要找到VLC的工具/偏好设置（在左下角点显示设置-&gt;全部）/输入、编解码器/音频编解码器/FluidSynth，把右边的SoundFont文件里面改为<code>/usr/share/soundfonts/FluidR3_GM.sf2</code>然后就可以播放了。</p>
<p>顺带一提，这个音源好像不是很好听，但是凑合着用吧。</p>
<p>「教程原视频」<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1e5411E7vA/?p=2&amp;vd_source=4663f9a4c778e1a074fa26b38bf7f76b">https://www.bilibili.com/video/BV1e5411E7vA/?p=2&amp;vd_source=4663f9a4c778e1a074fa26b38bf7f76b</a></p>
<p>我几乎完全没有按照这个教程来。</p>
<h2 id="亲自踩坑安装，和效果体验"><a href="#亲自踩坑安装，和效果体验" class="headerlink" title="亲自踩坑安装，和效果体验"></a>亲自踩坑安装，和效果体验</h2><p>在linux上应该会方便一点，因为我看了原视频，如果在windows上需要安装wget什么的</p>
<ol>
<li>安装torch</li>
</ol>
<pre><code class="lang-bash">pip install torch
</code></pre>
<p>这个命令敲好之后基本上如果你有nvidia的显卡的话应该会把cuda安装好。</p>
<p>如果慢的要记得换源，后面加-i再加清华源，可以自己去<a target="_blank" rel="noopener" href="https://tuna.moe">https://tuna.moe</a>上查看教程。</p>
<ol>
<li>把github上的项目克隆下来。</li>
</ol>
<pre><code class="lang-bash">git clone https://github.com/qiuqiangkong/piano_transcription_inference
</code></pre>
<p>如果你网络不幸不行，可以在github前面加个k使用他的镜像站。</p>
<p>github都上不去，中国的开源环境真是没救了。</p>
<pre><code class="lang-bash">git clone https://kgithub.com/qiuqiangkong/piano_transcription_inference
</code></pre>
<ol>
<li>运行项目</li>
</ol>
<pre><code class="lang-bash">python3 example.py --audio_path=&#39;input.mp3&#39; --output_midi_path=&#39;output.mid&#39; --cuda
</code></pre>
<p>如果你没有nvidia显卡的话后面—cuda别往上加了。</p>
<p>这个项目如果有显卡的话，是很快的，歌都放不完就扒好了，然后显卡的要求也没什么，我的MX350在linux下，很快就扒好了</p>
<ol>
<li>自动脚本</li>
</ol>
<p>这个项目直接使用pip安装下来的有点奇怪，他没有<code>example.py</code>, 也没有<code>__init__.py</code>，所以不能直接运行，所以我使用克隆。<br>但是克隆的问题就是它不能在除了这个目录以外的地方运行，不然<code>no such file</code>。<br>所以我写了个自动的，可以少敲命令。</p>
<pre><code class="lang-bash">#!/bin/bash

ex_path=&#39;/media/xht/Data/github/piano_transcription_inference&#39;
pwd1=$PWD

cd $ex_path

python3 example.py --audio_path=&quot;$pwd1/$1&quot; --output_midi_path=&quot;$pwd1/$2&quot; --cuda
</code></pre>
<p>自行修改<code>ex_path</code></p>
<h2 id="可能出现的问题"><a href="#可能出现的问题" class="headerlink" title="可能出现的问题"></a>可能出现的问题</h2><p>也许在<code>python3 example.py ……</code>的时候会出现<code>No librosa.core attribute audio</code>这样的错误提示，这样的提示大概说明了librosa的版本不兼容，所以要指定版本安装</p>
<pre><code class="lang-bash">pip install librosa==0.9.2
</code></pre>
<p>也许会提示什么<code>no such file</code>什么什么的error提示，那么这个时候你需要在运行example.py的时候当前目录PWD必须要在example.py那里，如果从其他的地方来运行的话，会报错。如果不在的花切换到那里。<br>对于这个问题，可以使用我之前提到过的脚本来运行。</p>
<p>README里面的Installation里面说要pip安装这个项目，实测不装，只是git clone也可以。</p>
<p>第一次运行的时候可能会大约200KB/s地下载一个160多MB的文件，这是正常的，等待一会就可以了。</p>

             
                <blockquote>
                    <p>文章作者：<a href="/ "> xht  </a></p>
                    <p>文章链接：<a href="http://xht8350.github.io/2023/06/18/%E9%92%A2%E7%90%B4AI%E6%89%92%E8%B0%B1/"> http://xht8350.github.io/2023/06/18/%E9%92%A2%E7%90%B4AI%E6%89%92%E8%B0%B1/ </a></p>
                    <p>版权声明：除另有声明外，本博客文章均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"> CC BY-NC-SA 4.0 </a> 许可协议。转载请注明原作者与文章出处。</p>
                </blockquote>
             
        </div>
        
            <p itemprop="keywords" class="tags">
                
                    <a href="/tags/%E9%9F%B3%E4%B9%90/"> 音乐 </a>
                
                    <a href="/tags/%E6%8A%80%E6%9C%AF/"> 技术 </a>
                
            </p>
        
    </article>
    <div class="post-near">
    <div class="post-near-child post-near-child-left "> 
        
            <a href="/2023/06/17/%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D%E7%AC%94%E8%AE%B0%E7%94%9F%E6%88%90%E5%99%A8/">英语单词笔记生成器 &laquo; </a>
        
        <br /> 上一篇  &laquo;
    </div>
    <div class="post-near-child post-near-child-right">
        
            <a href="/2023/06/29/%E5%9C%B0%E7%90%86%E5%AD%A6%E8%80%83%E5%A4%8D%E4%B9%A0/"> &raquo; 地理学考复习</a>
        
        <br /> &raquo; 下一篇 
    </div>
</div>
</div>
             
<div id="comments">
     
</div>
 
            <footer id="footer" role="contentinfo">
    
        &copy; 2020 - 2023
        <br />
    
    
    <br />
    
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_value_site_pv">......</span> visits ·
        <span id="busuanzi_value_site_uv">......</span> visitors 
    
</footer>
          </div>
        </div>
      </main>
      <!-- highlight support -->

    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/styles/default.min.css">


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/highlight.min.js"></script>
 
<script>
        hljs.initHighlightingOnLoad();
</script>
 
<!-- prettify support -->
 
<!-- mathjax support -->

    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src=""></script>


<!-- fancybox support -->
 
<!-- viewerjs support -->

    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/viewerjs@1.10.0/dist/viewer.min.css">


<script src="https://cdn.jsdelivr.net/npm/viewerjs@1.10.0/dist/viewer.min.js"></script>

<script type="text/javascript">
    Viewer.setDefaults({
        zoomRatio: [0.5],
        show: function () {
            this.viewer.zoomTo(1);
        },
    });
    
    var imageList = document.querySelector('.post-content').getElementsByTagName('img');
    
    var imageArray = new Array();
    Array.prototype.forEach.call(imageList, element => {
        if (element.alt != "no-view" && element.className != "no-view") {
            imageArray.push(element);
        }
    });
    
    Array.prototype.forEach.call(imageArray, element => {
        var viewer1 = new Viewer(element);
        viewer1.images = imageArray;
        viewer1.length = imageArray.length;
    });
</script>
 
<!-- google analytics support -->



 
 

<!-- lazyload support -->

    
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.4.0/dist/lazyload.min.js"></script>

<script>
    new LazyLoad({
        elements_selector: '.post-content img'
    });
</script>
 
  </body>

</html>